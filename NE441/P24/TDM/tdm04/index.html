


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.12">
    
    
      
        <title>TDM04 - ESISAR -  NE441</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4dd2dd8d.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tdm04" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="ESISAR -  NE441" class="md-header-nav__button md-logo" aria-label="ESISAR -  NE441">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ESISAR -  NE441
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              TDM04
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ESISAR -  NE441" class="md-nav__button md-logo" aria-label="ESISAR -  NE441">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ESISAR -  NE441
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../intro/index.html" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../exemples/index.html" title="Exemples du cours" class="md-nav__link">
      Exemples du cours
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../aidememoire/index.html" title="Aide mémoire Java" class="md-nav__link">
      Aide mémoire Java
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../outils/index.html" title="Aide Eclipse" class="md-nav__link">
      Aide Eclipse
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../rappel_reseau/index.html" title="Rappels réseau" class="md-nav__link">
      Rappels réseau
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tdm01/index.html" title="TDM01" class="md-nav__link">
      TDM01
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tdm02/index.html" title="TDM02" class="md-nav__link">
      TDM02
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tdm03/index.html" title="TDM03" class="md-nav__link">
      TDM03
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        TDM04
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./index.html" title="TDM04" class="md-nav__link md-nav__link--active">
      TDM04
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercice-1-lecture-dun-fichier" class="md-nav__link">
    Exercice 1 : Lecture d'un fichier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-2-ecriture-dun-fichier" class="md-nav__link">
    Exercice 2 : Ecriture d'un fichier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-3-copie-dun-fichier" class="md-nav__link">
    Exercice 3 :Copie d'un fichier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-4-test-de-votre-programme-de-copie-de-fichiers" class="md-nav__link">
    Exercice 4 : Test de votre programme de copie de fichiers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-5-transfert-de-fichier-par-socket-tcpip-sans-choix-du-fichier" class="md-nav__link">
    Exercice 5 : Transfert de fichier par socket TCP/IP (sans choix du fichier)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-6-transfert-de-fichier-par-socket-tcpip-avec-choix-du-fichier" class="md-nav__link">
    Exercice 6 : Transfert de fichier par socket TCP/IP (avec choix du fichier)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-7-amelioration-du-transfert-de-fichiers" class="md-nav__link">
    Exercice 7 : Amélioration du transfert de fichiers
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tdm05/index.html" title="TDM05" class="md-nav__link">
      TDM05
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tdm06/index.html" title="TDM06" class="md-nav__link">
      TDM06
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tdm08/index.html" title="TDM08" class="md-nav__link">
      TDM08
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tdm09/index.html" title="TDM09" class="md-nav__link">
      TDM09
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tdm10/index.html" title="TDM10" class="md-nav__link">
      TDM10
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#exercice-1-lecture-dun-fichier" class="md-nav__link">
    Exercice 1 : Lecture d'un fichier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-2-ecriture-dun-fichier" class="md-nav__link">
    Exercice 2 : Ecriture d'un fichier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-3-copie-dun-fichier" class="md-nav__link">
    Exercice 3 :Copie d'un fichier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-4-test-de-votre-programme-de-copie-de-fichiers" class="md-nav__link">
    Exercice 4 : Test de votre programme de copie de fichiers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-5-transfert-de-fichier-par-socket-tcpip-sans-choix-du-fichier" class="md-nav__link">
    Exercice 5 : Transfert de fichier par socket TCP/IP (sans choix du fichier)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-6-transfert-de-fichier-par-socket-tcpip-avec-choix-du-fichier" class="md-nav__link">
    Exercice 6 : Transfert de fichier par socket TCP/IP (avec choix du fichier)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exercice-7-amelioration-du-transfert-de-fichiers" class="md-nav__link">
    Exercice 7 : Amélioration du transfert de fichiers
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="tdm04">TDM04<a class="headerlink" href="#tdm04" title="Permanent link">&para;</a></h1>
<h2 id="exercice-1-lecture-dun-fichier">Exercice 1 : Lecture d'un fichier<a class="headerlink" href="#exercice-1-lecture-dun-fichier" title="Permanent link">&para;</a></h2>
<p>L'objectif de cet exercice est de comprendre le fonctionnement de la lecture d'un fichier sur le système de fichier.
Nous allons illustrer ce fonctionnement par un programme en Java, mais il faut noter que ce fonctionnement est strictement identique en lanage C ou dans un autre langage.</p>
<p>Commencez par créer un fichier <code>/home/userir/lecture_fichier.txt</code> avec votre outil favori (vi, nano, ...). Dans ce fichier, vous pouvez placer un texte quelconque, d'une longueur d'au moins 30 caractères.</p>
<p>Voici maintenant un exemple de code à utiliser pour afficher le contenu de votre fichier :</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleFileReader</span> 
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="p">{</span>
        <span class="n">SampleFileReader</span> <span class="n">fr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleFileReader</span><span class="p">();</span>
        <span class="n">fr</span><span class="p">.</span><span class="na">execute</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="cm">/**</span>
<span class="cm">     * </span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">execute</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">IOException</span>
    <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Début lecture du fichier&quot;</span><span class="p">);</span>

        <span class="n">FileInputStream</span> <span class="n">fis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="p">(</span><span class="s">&quot;c:/tmp/lecture_fichier.txt&quot;</span><span class="p">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">10</span><span class="o">]</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">fis</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
        <span class="k">while</span><span class="p">(</span><span class="n">len</span><span class="o">!=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">displayBufContent</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="n">len</span><span class="p">);</span>
            <span class="n">len</span> <span class="o">=</span> <span class="n">fis</span><span class="p">.</span><span class="na">read</span><span class="p">(</span><span class="n">buf</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="n">fis</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Fin lecture du fichier&quot;</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">displayBufContent</span><span class="p">(</span><span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;len=&quot;</span><span class="o">+</span><span class="n">len</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> 
        <span class="p">{</span>
            <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Caractère lu : &quot;</span><span class="o">+</span><span class="n">buf</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Executez cet exemple de code.
Ce programme affiche en décimal le code ASCII de chaque caractère du fichier. Vous trouverez avec ce lien une table de corresponsance :</p>
<p><a href="https://fr.wikibooks.org/wiki/Les_ASCII_de_0_%C3%A0_127/La_table_ASCII#Descriptif" target="_blank">Tableau ASCII </a></p>
<p>Voici un schéma explicatif sur le transfert des données vers le buffer : </p>
<p><img alt="Placeholder" src="schema.png" /></p>
<h2 id="exercice-2-ecriture-dun-fichier">Exercice 2 : Ecriture d'un fichier<a class="headerlink" href="#exercice-2-ecriture-dun-fichier" title="Permanent link">&para;</a></h2>
<p>Nous allons maintenant étudier un programme en Java écrivant dans un fichier.</p>
<p>Voici maintenant un exemple de code à utiliser pour écrire le contenu d'un fichier : </p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleFileWriter</span> 
<span class="p">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
    <span class="p">{</span>
        <span class="n">SampleFileWriter</span> <span class="n">fr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleFileWriter</span><span class="p">();</span>
        <span class="n">fr</span><span class="p">.</span><span class="na">execute</span><span class="p">();</span>
    <span class="p">}</span>


    <span class="cm">/**</span>
<span class="cm">     * </span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">execute</span><span class="p">()</span> <span class="kd">throws</span> <span class="n">IOException</span>
    <span class="p">{</span>
        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Début écriture du fichier&quot;</span><span class="p">);</span>

        <span class="n">FileOutputStream</span> <span class="n">fos</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="p">(</span><span class="s">&quot;c:/tmp/ecriture_fichier.txt&quot;</span><span class="p">);</span>


        <span class="kt">byte</span><span class="o">[]</span> <span class="n">buf</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">10</span><span class="o">]</span><span class="p">;</span>

        <span class="n">buf</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="mi">69</span><span class="p">;</span>
        <span class="n">buf</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="mi">83</span><span class="p">;</span>
        <span class="n">buf</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span> <span class="o">=</span> <span class="mi">73</span><span class="p">;</span>
        <span class="n">buf</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span> <span class="o">=</span> <span class="mi">83</span><span class="p">;</span>
        <span class="n">buf</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span> <span class="o">=</span> <span class="mi">65</span><span class="p">;</span>
        <span class="n">buf</span><span class="o">[</span><span class="mi">5</span><span class="o">]</span> <span class="o">=</span> <span class="mi">82</span><span class="p">;</span>


        <span class="c1">// Ecriture des 6 premiers octets du buffer </span>
        <span class="n">fos</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>

        <span class="c1">// Fermeture du fichier</span>
        <span class="n">fos</span><span class="p">.</span><span class="na">close</span><span class="p">();</span>

        <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Fin écriture du fichier&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>Executez cet exemple de code et étudiez le.</p>
<h2 id="exercice-3-copie-dun-fichier">Exercice 3 :Copie d'un fichier<a class="headerlink" href="#exercice-3-copie-dun-fichier" title="Permanent link">&para;</a></h2>
<p>Réalisez maintenant un programme simple de copie de fichier : votre programme doit copier le fichier <code>/home/userir/file1</code> vers le fichier <code>/home/userir/file2</code></p>
<p>Vous devez vous inspirer des deux exemples précédents (utilisez uniquement les classes FileInputStream et FileOutputStream, et <strong>uniquement</strong> les méthodes read, write et close de ces classes).</p>
<p>Votre programme doit aussi afficher le temps mis pour réaliser la copie.</p>
<p>Voici un exemple pour mesurer le temps :</p>
<div class="highlight"><pre><span></span><code><span class="kt">long</span> <span class="n">start</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>
<span class="c1">// </span>
<span class="c1">// Your code here</span>
<span class="c1">// </span>
<span class="kt">long</span> <span class="n">stop</span> <span class="o">=</span> <span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Elapsed Time = &quot;</span><span class="o">+</span><span class="p">(</span><span class="n">stop</span><span class="o">-</span><span class="n">start</span><span class="p">)</span><span class="o">+</span><span class="s">&quot; ms&quot;</span><span class="p">);</span>
</code></pre></div>

<h2 id="exercice-4-test-de-votre-programme-de-copie-de-fichiers">Exercice 4 : Test de votre programme de copie de fichiers<a class="headerlink" href="#exercice-4-test-de-votre-programme-de-copie-de-fichiers" title="Permanent link">&para;</a></h2>
<p>Créer un fichier de 1Go en utilisant la commande suivante </p>
<div class="highlight"><pre><span></span><code>dd <span class="k">if</span><span class="o">=</span>/dev/urandom <span class="nv">of</span><span class="o">=</span>file1 <span class="nv">bs</span><span class="o">=</span><span class="m">1000000</span> <span class="nv">count</span><span class="o">=</span><span class="m">1000</span>
</code></pre></div>

<p>Utiliser le programme de l'exercice 1 pour copier ce fichier de 1Go, et mesurer le temps mis pour faire cette copie.</p>
<p>Vérifier que votre copie est correcte en utilisant l'utilitaire diff.</p>
<div class="highlight"><pre><span></span><code>diff file1 file2 
</code></pre></div>

<p>Faites maintenant varier la taille du buffer utilisé par votre programme (vous testerez avec une taille de buffer de 10,100,1000,10_000,1_000_000).</p>
<p>Tracez la courbe du temps mis en fonction de la taille du buffer. </p>
<h2 id="exercice-5-transfert-de-fichier-par-socket-tcpip-sans-choix-du-fichier">Exercice 5 : Transfert de fichier par socket TCP/IP (sans choix du fichier)<a class="headerlink" href="#exercice-5-transfert-de-fichier-par-socket-tcpip-sans-choix-du-fichier" title="Permanent link">&para;</a></h2>
<p>Ecrire un programme client et un programme serveur qui permettent l'échange d'un seul fichier (toujours le même).</p>
<p>Le programme client se connecte au serveur, le serveur retourne au client le contenu du fichier <code>/home/userir/file_serveur.txt</code> (vous pouvez mettre en dur ce nom de fichier dans votre programme serveur).</p>
<p>Le programme client sauvegarde le fichier reçu dans le fichier <code>/home/userir/file_client.txt</code> (vous pouvez mettre en dur ce nom de fichier dans votre programme client).</p>
<p>Faites des essais avec un fichier <code>file_serveur.txt</code> de 1Go. Mesurez le temps mis pour le transfert.</p>
<p>Vérifier que votre copie est correcte en utilisant l'utilitaire diff.</p>
<h2 id="exercice-6-transfert-de-fichier-par-socket-tcpip-avec-choix-du-fichier">Exercice 6 : Transfert de fichier par socket TCP/IP (avec choix du fichier)<a class="headerlink" href="#exercice-6-transfert-de-fichier-par-socket-tcpip-avec-choix-du-fichier" title="Permanent link">&para;</a></h2>
<p>Ecrire un programme client et un programme serveur qui permettent l'échange de fichier, avec choix du fichier par le client.</p>
<p>Le programme client envoie au serveur le nom du fichier qu'il souhaite obtenir. Le serveur retourne au client le fichier demandé.</p>
<p>Le programme client sauvegarde le fichier demandé dans le répertoire courant.</p>
<p>Vérifier que votre copie est correcte en utilisant l'utilitaire diff.</p>
<p>Attention : le transfert du nom du fichier n'est pas un problème trivial. Réfléchissez à la méthode qu'il faut utiliser pour savoir que l'on a lu tout le nom du fichier.</p>
<h2 id="exercice-7-amelioration-du-transfert-de-fichiers">Exercice 7 : Amélioration du transfert de fichiers<a class="headerlink" href="#exercice-7-amelioration-du-transfert-de-fichiers" title="Permanent link">&para;</a></h2>
<p>Modifiez le programme précédent pour faire un affichage de l'avancement du téléchargement sur le client.</p>
<p>Pour cela, il est nécessaire que le serveur retourne au client la taille du fichier avant d'envoyer son contenu.</p>
<p>Coté serveur, pour connaître la taille du fichier, il faut utiliser le code Java suivant : </p>
<div class="highlight"><pre><span></span><code><span class="n">String</span> <span class="n">nomFichier</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">File</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="p">(</span><span class="n">nomFichier</span><span class="p">);</span>
<span class="kt">long</span> <span class="n">fileSize</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="na">length</span><span class="p">();</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
      
    </div>
    
      <script src="../assets/javascripts/vendor.3636a4ec.min.js"></script>
      <script src="../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ["instant"],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>